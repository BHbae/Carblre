<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
<%@ include file="../layout/subHeader.jsp" %>

<div class="wrap">
    <section style="margin-bottom: 100px"></section>
    <div class="inner--container">
        <div class="sub--content">
            <h2 class="prih2 user--form">변호사 회원가입</h2>
            <div class="terms--into infoupdate" style="box-sizing: border-box; margin-bottom: 10px;">
                <p>
                    제 1 조 (목적)<br>
                    이 약관은 전기통신사업법 및 동법 시행령에 의하여 전라북도지방변호사회(이하 "변호사회"이라고 한다)이 제공하는 변호사회 서비스(이하 "서비스"라 한다)의 이용조건 및 절차에 관한 사항을 규정함을 목적으로 합니다.
                    <br><br>
                    제 2 조 (약관의 공지 및 준용)<br>
                    ① 이 약관의 내용은 서비스 화면에 게시하거나 기타의 방법으로 회원에게 공지함으로써 효력을 발생합니다.<br>
                    ② 변호사회은 이 약관을 변경할 수 있으며, 변경된 약관은 제1항과 같은 방법으로 공지함으로써 효력을 발생합니다.<br>

                    제 3 조 (약관 외 준칙)<br>
                    이 약관에 명시되지 않은 사항은 전기통신기본법, 전기통신사업법 및 기타 관련법령의 규정에 의합니다.<br><br>

                    제 4 조 (용어의 정의)<br>
                    이 약관에서 사용하는 용어의 정의는 다음과 같습니다.<br>
                    - 회원 : 변호사회과 서비스 이용계약을 체결한 자<br>
                    - 아이디(ID) : 회원 식별과 회원의 서비스 이용을 위하여 회원이 선정하고 변호사회이 승인하는 문자와 숫자의 조합<br>
                    - 비밀번호 : 회원의 비밀 보호를 위해 회원 자신이 설정한 문자와 숫자의 조합<br>
                    - 운영자 : 서비스의 전반적인 관리와 원활한 운영을 위하여 변호사회에서 선정한 사람<br>
                    - 해지 : 변호사회 또는 회원이 서비스 개통 후 이용계약을 해약하는 것<br><br>

                    제 2 장 서비스 이용계약
                    <br><br>
                    제 5 조 (이용계약의 성립)<br>
                    ① 아래 "위의 이용약관에 동의하십니까?" 라는 물음에 회원이 "예" 단추를 누르면 이 약관에 동의하는 것으로 간주됩니다.<br>
                    ② 이용계약은 회원의 이용신청에 대하여 변호사회이 승낙함으로써 성립합니다.<br><br>

                    제 6 조 (이용신청)<br>
                    이용신청은 온라인으로 가입(회원가입)신청서 양식에 내용을 기록하여 신청합니다.<br><br>

                    제 7 조 (이용신청의 승낙)<br>
                    ① 변호사회은 회원이 가입신청서의 필수기재 항목을 정확히 기재하여 이용신청을 하였을때 승낙합니다.<br>
                    ② 변호사회은 다음 각 호중 하나에 해당하는 이용신청에 대하여는 승낙을 유보할 수 있습니다.<br>
                    1) 설비에 여유가 없는 경우<br>
                    2) 기술상 지장이 있는 경우<br>
                    3) 기타 변호사회이 필요하다고 인정되는 경우<br>
                    ③ 변호사회은 다음 각 호중 하나에 해당하는 이용신청에 대하여는 이를 승낙하지 아니 할 수 있습니다.<br>
                    1) 이름이 실명이 아닌 경우<br>
                    2) 다른 사람의 명의를 사용하여 신청한 경우<br>
                    3) 이용신청시 필요내용을 허위로 기재하여 신청한 경우<br>
                    4) 변호사회의 안녕질서 또는 미풍양속을 저해할 목적으로 신청한 경우<br>
                    5) 기타 변호사회이 정한 이용신청요건이 미비되었을 때<br><br>

                    제 8 조 (계약사항의 변경)<br>
                    ① 회원은 이용신청시 기재한 사항이 변경되었을 경우에는 온라인수정을 해야 합니다.<br>
                    ② 이용신청시 기재한 사항이 변경되었을 경우에 수정하지 않아 발생하는 모든 결과에 대한 책임은 회원에게 있습니다.<br><br>

                    제 3 장 서비스 이용<br><br>

                    제 9 조 (변호사회의 의무)<br>
                    변호사회은 서비스 제공과 관련해서 알고 있는 회원의 신상정보를 본인의 승낙없이 제3자에게 누설, 배포하지 않습니다. 단, 전기통신기본법 등 법률의 규정에 의해 국가 기관의 요구가 있는 경우, 범죄에 대한 수사상의 목적이 있거나 정보통신윤리위원회의 요청이 있는 경우, 또는 기타 관계법령에서 정한 절차에 따른 요청이 있는 경우에는 그러하지 않습니다.
                    <br><br>
                    제 10 조 (회원 아이디(ID)와 비밀번호 관리에 대한 의무)<br>
                    ① 아이디(ID)와 비밀번호에 관한 모든 관리책임은 회원에게 있습니다.<br>
                    회원에게 부여된 아이디(ID)와 비밀번호의 관리소홀, 부정사용에 의하여 발생하는 모든 결과에 대한 책임은 회원에게 있습니다.<br>
                    ② 자신의 아이디(ID)가 부정하게 사용된 경우 회원은 반드시 변호사회에 그 사실을 통보 해야 합니다.<br><br>

                    제 11 조 (서비스 전반에 관한 회원의 의무)<br>
                    ① 회원은 서비스를 이용할 때 다음 각 호의 행위를 하지 않아야 합니다.<br>
                    1) 다른 회원의 ID를 부정하게 사용하는 행위<br>
                    2) 서비스에서 얻은 정보를 변호사회의 사전승낙 없이 회원의 이용이외의 목적으로 복제하거나 이를 출판 및 방송 등에 사용하거나 제 3자에게 제공하는 행위<br>
                    3) 제3자의 저작권 등 기타 권리를 침해하는 행위<br>
                    4) 공공질서 및 미풍양속에 위반되는 내용의 정보, 문장, 도형 등을 타인에게 유포하는 행위<br>
                    5) 범죄와 결부된다고 객관적으로 판단되는 행위<br>
                    6) 기타 관계법령에 위배되는 행위<br>
                    ② 회원은 이 약관에서 규정하는 사항과 서비스 이용안내 또는 주의사항을 준수하여야 합니다.<br>
                    ③ 회원은 내용별로 변호사회이 서비스 공지사항에 게시하거나 별도로 공지한 이용제한 사항을 준수하여야 합니다.<br>
                    ④ 회원은 변호사회의 사전승낙 없이는 서비스를 이용하여 영업활동을 할 수 없으며, 영업활동의 결과와 회원이 약관에 위반한 영업활동을 이용하여 발생한 결과에 대하여 변호사회은 책임을 지지 않습니다.
                    <br><br>
                    제 12조 (정보의 제공)<br>
                    변호사회은 회원에게 서비스 이용, 변호사회의 각종 행사, 기타 다양한 정보서비스를 전자우편이나 서신우편, 기타 방법으로 제공할 수 있습니다.<br><br>

                    제 13 조 (회원의 게시물)<br>
                    변호사회은 회원이 게시하거나 등록하는 서비스내의 내용물이 다음 각 호의 1에 해당한 다고 판단되는 경우에 사전통지 없이 삭제할 수 있습니다.<br>
                    1) 다른 회원 또는 제3자를 비방하거나 중상모략으로 명예를 손상시키는 내용인 경우<br>
                    2) 공공질서 및 미풍양속에 위반되는 내용인 경우<br>
                    3) 범죄적 행위에 결부된다고 인정되는 내용인 경우<br>
                    4) 제 3 자의 저작권 등 기타 권리를 침해하는 내용인 경우<br>
                    5) 변호사회에서 규정한 게시기간을 초과한 경우<br>
                    6) 기타 관계법령에 위반된다고 판단되는 경우<br><br>

                    제 14 조 (게시물의 저작권)<br>
                    서비스에 게재된 자료에 대한 권리는 다음 각 호와 같습니다.<br>
                    1) 게시물에 대한 권리와 책임은 게시자에게 있으며 변호사회은 게시자의 동의 없이는 이를 영리적 목적으로 사용할 수 없습니다. 단, 비영리적인 경우는 그러하지 아니하며 또한 서비스내의 게재권을 갖습니다.<br>
                    2) 회원은 서비스를 이용하여 얻은 정보를 가공, 판매하는 행위 등 서비스에 게재된 자료를 상업적으로 사용할 수 없습니다.<br><br>

                    제 15 조 (서비스 이용시간)<br>
                    ① 서비스의 이용은 변호사회의 업무상 또는 기술상 특별한 지장이 없는 한 연중무휴 1일 24시간을 원칙으로 합니다.<br>
                    다만 정기 점검 등의 필요로 변호사회이 정한 날이나 시간은 그러하지 않습니다.<br>
                    ② 변호사회은 서비스를 일정범위로 분할하여 각 범위별로 이용가능시간을 별도로 정할 수 있으며 이 경우 그 내용을 사전에 공지합니다.<br><br>

                    제 16 조 (서비스 제공의 중지)<br>
                    ① 변호사회은 다음 각 호에 해당하는 경우 서비스 제공을 중지할 수 있습니다.<br>
                    1) 서비스용 설비의 보수 등 공사로 인한 부득이한 경우<br>
                    2) 전기통신사업법에 규정된 기간통신사업자가 전기통신서비스를 중지했을 경우<br>
                    ② 변호사회은 국가비상사태, 정전, 서비스 설비의 장애 또는 서비스 이용의 폭주 등으로 정상적인 서비스 이용에 지장이 있는 때에는 서비스의 전부 또는 일부를 제한 하거나 정지할 수 있습니다.<br><br>

                    제 4 장 계약해지 및 이용제한<br><br>

                    제 17 조 (계약해지 및 이용제한)<br>
                    ① 회원이 이용계약을 해지하고자 하는 때에는 회원 본인이 온라인을 통해 변호사회에 해지신청을 하여야 합니다.<br>
                    ② 변호사회은 회원이 다음 각 호에 해당하는 행위를 하였을 경우 사전통지 없이 이용계약을 해지하거나 또는 기간을 정하여 서비스 이용을 중지할 수 있습니다.<br>
                    1) 타인의 서비스 ID 및 비밀번호를 도용한 경우<br>
                    2) 서비스 운영을 고의로 방해한 경우<br>
                    3) 가입한 이름이 실명이 아닌 경우<br>
                    4) 같은 사용자가 다른 ID로 이중등록을 한 경우<br>
                    5) 공공질서 및 미풍양속에 저해되는 내용을 고의로 유포시킨 경우<br>
                    6) 회원이 국익 또는 변호사회 공익을 저해할 목적으로 서비스 이용을 계획 또는 실행하는 경우<br>
                    7) 타인의 명예를 손상시키거나 불이익을 주는 행위를 한 경우<br>
                    8) 기타 변호사회이 정한 이용조건에 위반한 경우<br><br>

                    제 5 장 손해배상 등<br><br>

                    제 18 조 (손해배상)<br>
                    변호사회은 서비스 요금이 무료인 서비스 이용과 관련하여 회원에게 발생한 어떠한 손해에 관하여도 책임을 지지 않습니다.<br>
                    서비스 유료화 이후에 관하여는 별도로 정합니다.<br><br>

                    제 19 조 (면책조항)<br>
                    ① 변호사회은 천재지변 또는 이에 준하는 불가항력으로 인하여 서비스를 제공할 수 없는 경우에는 서비스 제공에 관한 책임이 면제됩니다.<br>
                    ② 변호사회은 회원의 귀책사유로 인한 서비스 이용의 장애에 대하여 책임을 지지 않습니다.<br>
                    ③ 변호사회은 회원이 서비스를 이용하여 기대하는 손익이나 서비스를 통하여 얻은 자료로 인한 손해에 관하여 책임을 지지 않습니다.<br>
                    ④ 변호사회은 회원이 서비스에 게재한 정보, 자료, 사실의 신뢰도, 정확성 등 내용에 관하여는 책임을 지지 않습니다.<br><br>

                    제 20조 (관할법원)<br>
                    요금 등 서비스 이용으로 발생한 분쟁에 대해 소송이 제기될 경우 변호사회의 본사 소재지를 관할하는 법원을 관할법원으로 합니다.<br>

                    [부칙]<br>

                    이 약관은 2024년 11월 01일부터 시행합니다.<br>
                    이 약관은 이 약관이 제정되기 전에 가입한 회원에게도 적용됩니다.<br>
                    회원의 개인정보에 대해서는 변호사회 '개인정보 보호방침'이 작용됩니다.<br>
                </p>
            </div>
            <div class="checkbox infoupdate">
                <label>동의 (*필수)<input type="checkbox" required></label>
            </div>

        <form action="/lawyer/lawyerSignUp" method="POST"  enctype="multipart/form-data">
                <!-- 사용자 이름 -->
                <div class="form-group">
                    <label for="userName">이름 </label>
                    <input type="text" class="form-control" id="userName" placeholder="이름을 입력하세요." name="userName" required>
                </div>

                <div class="form-group">
                    <label for="nickName">아이디</label>
                    <input type="text" class="form-control" id="nickName" placeholder="아이디를 입력하세요." name="nickName"
                           required>
                    <button type="button" class="check--btn" id="checkId" onclick="checkDuplicate()">
                        중복 확인
                    </button>
                </div>

                <div class="form-group">
                    <label for="password">비밀번호</label>
                    <input type="password" class="form-control" id="password" placeholder="비밀번호를 입력하세요." name="password"
                           oninput="pwCheck()" minlength="8" maxlength="20" required>
                    <p class="pw--info">
                        8자 이상 20자 이하 입력 (공백 제외) <br>영문/숫자/특수문자(!@#$%^&*)포함
                    </p>
                </div>

                <div class="form-group">
                    <label for="passwordCheck">비밀번호 확인
                        <span id="pwConfirm">

                </span>
                    </label>
                    <input type="password" class="form-control" id="passwordCheck" placeholder="비밀번호를 한 번 더 입력하세요."
                           name="passwordCheck" oninput="pwCheck()" minlength="8" maxlength="20" required>
                </div>

                <!-- 이메일 입력란 -->
                <div class="form-group">
                    <label for="email">이메일</label>
                    <input type="email" class="form-control" id="email" placeholder="example@carblre.com" name="email"
                           value="" required>
                </div>

                <!-- 이메일 인증코드 발송 -->
                <div class="form-group">
                    <button type="button" class="check--btn" id="emailCode" onclick="sendValidate()">발송</button>
                    <button type="button" class="check--btn" id="checkValidate" onclick="checkValidate()"
                            disabled="disabled" style="cursor: pointer;">인증 확인
                    </button>
                </div>

                <!-- 전화번호 이름 -->
                <div class="form-group">
                    <label for="phoneNum">전화번호 </label>
                    <input type="text" class="form-control" id="phoneNum" placeholder="전화번호를 입력하세요." name="phoneNum"
                           required>
                </div>

                <!-- 이미지  -->
                <div class="form-group">
                    <label for="profileImage">프로필 </label>
                    <input type="file" class="form-control" id="profileImage" name="profileImage" accept="image/*"
                           onchange="ProfilePreviewImage(event)" placeholder="이미지 파일을 선택하세요." style="padding: 5px;" required>
                </div>

                <!-- 미리보기를 보여줄 요소 -->
                <img id="ProfileImagePreview" src="" alt="이미지 미리보기" style="display: none; width: 200px; height: auto;"/>

                <!-- 변호증 이미지  -->
                <div class="form-group">
                    <label for="licenseImage">변호증 </label>
                    <input type="file" class="form-control" id="licenseImage" name="licenseImage" accept="image/*"
                           onchange="LawyerPreviewImage(event)" style="padding: 5px;" placeholder="이미지 파일을 선택하세요." required>
                </div>

                <!-- 미리보기를 보여줄 요소 -->
                <img id="LawyerImagePreview" src="" alt="이미지 미리보기" style="display: none; width: 200px; height: auto;"/>

                <!-- 자기소개 textarea -->
                <div class="form-group">
                    <label for="introduction">소개 </label>
                    <textarea class="form-control" id="introduction" placeholder="소개를 입력해주세요" name="introduction"
                              required></textarea>
                </div>

                <!-- 로펌 이름 -->
                <div class="form-group">
                    <label for="lawFirm">법인 이름 </label>
                    <input type="text" class="form-control" id="lawFirm" placeholder="법인 이름을 입력하세요." name="lawFirm"
                           required>
                </div>

                <!-- 법인 번호 -->
                <div class="form-group">
                    <label for="officeNum">법인 번호 </label>
                    <input type="text" class="form-control" id="officeNum" placeholder="법인 전화번호를 입력하세요."
                           name="officeNum" required>
                </div>

                <!-- 제출 버튼 -->
                <button type="submit" id="signUp">가입하기</button>
            </form>
        </div>
    </div>
</div>

<script>

    function sendValidate() {
        const email = document.getElementById('email').value;
        console.log('Email : ' + email);

        fetch('http://localhost:8080/send-mail/email?email=' + email)
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.message || '알 수 없는 에러가 발생했습니다.');
                    });
                }
                // 응답을 JSON 형식으로 변환
                return response.json();
            })
            .then(data => {
                // 서버로부터 받은 응답 데이터를 처리
                console.log('Success:', data);
                // EmailController에서 보낸 response를 alert으로 표시
                alert(data.message);
                const sendBtn = document.getElementById('emailCode');
                const checkValidate = document.getElementById('checkValidate');
                sendBtn.disabled = true;
                checkValidate.disabled = false;
            })
            .catch(error => {
                console.log('Error:', error);
                // 에러 메시지를 alert으로 표시
                alert(error.message);
            });
    }

    // '중복 확인' 버튼을 클릭하면 실행됩니다.
    function checkDuplicate() {
        const userId = document.getElementById('nickName').value;
        console.log('userId : ', userId);

        fetch(`http://localhost:8080/user/checkId?userId=` + userId)
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.message || '알 수 없는 에러가 발생했습니다.');
                    });
                }
                return response.json();  // 응답을 JSON 형식으로 변환
            })
            .then(data => {
                if (data.message) {
                    alert("사용 가능한 아이디입니다.");
                    const result = confirm("해당 아이디를 사용하시겠습니까?");

                    if (result) {
                        const inputUserId = document.getElementById('nickName').value;
                        inputUserId.disabled = true;
                    }

                } else {
                    alert("사용 중인 아이디입니다.");
                }
            })
            .catch(error => {
                console.log('Error:', error);
                alert(error.message);
            });
    }


    function checkValidate() {

        fetch('http://localhost:8080/send-mail/checkValidate')
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.message || '알 수 없는 에러가 발생했습니다.');
                    });
                }
                return response.json();  // 응답을 JSON 형식으로 변환
            })
            .then(data => {
                // 서버로부터 받은 응답 데이터를 처리
                console.log('Success:', data);
                // 서버에서 보낸 메시지를 alert으로 표시
                alert(data.message);
                const signUpBtn = document.getElementById('signUp');
                const emailInput = document.getElementById('email');
                const checkValidateBtn = document.getElementById('checkValidate');

                signUpBtn.disabled = false;
                checkValidateBtn.disabled = true;
                emailInput.readOnly = true;

            })
            .catch(error => {
                console.log('Error:', error);
                // 에러 메시지를 alert으로 표시
                alert(error.message);
            });
    }


    const autoHyphen = (target) => {
        target.value = target.value
            .replace(/[^0-9]/g, '')
            .replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g, "$1-$2-$3").replace(/(\-{1,2})$/g, "");
    }

    // 이미지 띄우기
    function ProfilePreviewImage(event) {
        const file = event.target.files[0];  // 선택한 파일
        const preview = document.getElementById('ProfileImagePreview');  // 미리보기 이미지 요소

        // 파일이 이미지인지 확인
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();

            // 파일을 읽고 나면 발생하는 이벤트
            reader.onload = function (e) {
                preview.src = e.target.result;  // 이미지의 data URL을 미리보기 요소에 설정
                preview.style.display = 'block';  // 이미지를 표시
            };

            reader.readAsDataURL(file);  // 파일을 읽어서 base64 형식의 URL로 변환
        } else {
            preview.src = '';  // 이미지가 아닌 경우 미리보기 이미지 제거
            preview.style.display = 'none';  // 미리보기 숨김
            alert("이미지 파일을 선택해주세요.");
        }
    }

    // 이미지 띄우기
    function LawyerPreviewImage(event) {
        const file = event.target.files[0];  // 선택한 파일
        const preview = document.getElementById('LawyerImagePreview');  // 미리보기 이미지 요소

        // 파일이 이미지인지 확인
        if (file && file.type.startsWith('image/')) {
            const reader = new FileReader();

            // 파일을 읽고 나면 발생하는 이벤트
            reader.onload = function (e) {
                preview.src = e.target.result;  // 이미지의 data URL을 미리보기 요소에 설정
                preview.style.display = 'block';  // 이미지를 표시
            };

            reader.readAsDataURL(file);  // 파일을 읽어서 base64 형식의 URL로 변환
        } else {
            preview.src = '';  // 이미지가 아닌 경우 미리보기 이미지 제거
            preview.style.display = 'none';  // 미리보기 숨김
            alert("이미지 파일을 선택해주세요.");
        }
    }
</script>
<%@ include file="../layout/footer.jsp" %>